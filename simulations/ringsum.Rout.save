
R version 3.2.2 (2015-08-14) -- "Fire Safety"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # This justifies why you need to sum in a ring.
> 
> N <- 18
> out <- list()
> for (x in 2:N) {
+     y <- integer(N)
+     y[x-0:1] <- 1
+     out[[x]] <- y
+ }
> 
> y <- integer(N)
> y[1] <- y[N] <- 1
> out[[1]] <- y
> X <- do.call(rbind, out)
> X <- rbind(X, diag(N))
> w <- rep(c(1, 1e-6), each=N)^0.5
> 
> set.seed(10)
> err.sum1 <- err.sum2 <- list()
> for (it in 1:100) { 
+     true.facs <- c(1:10/10, 9:2/10)
+     obs <- X %*% true.facs
+     obs <- obs * runif(length(obs), 0.8, 1.2)
+     err.sum1[[it]] <- as.vector(abs(solve(qr(X*w), obs*w) - true.facs)/true.facs)
+     
+     true.facs <- c(0.1, 1, 0.2, 0.9, 0.3, 0.8, 0.4, 0.7, 0.5, 0.6, 0.6, 0.5, 0.7, 0.4, 0.8, 0.3, 0.9, 0.2)
+     obs <- X %*% true.facs
+     obs <- obs * runif(length(obs), 0.8, 1.2)
+     err.sum2[[it]] <- as.vector(abs(solve(qr(X*w), obs*w) - true.facs)/true.facs)
+ }
> 
> summary(do.call(rbind, err.sum1)[,1:10])
       V1                V2               V3                  V4         
 Min.   :0.01337   Min.   :0.0125   Min.   :0.0007147   Min.   :0.01054  
 1st Qu.:0.35439   1st Qu.:0.1715   1st Qu.:0.1091164   1st Qu.:0.09248  
 Median :0.67676   Median :0.3739   Median :0.2248381   Median :0.19368  
 Mean   :0.79434   Mean   :0.4178   Mean   :0.2857213   Mean   :0.26861  
 3rd Qu.:1.09059   3rd Qu.:0.6229   3rd Qu.:0.3780330   3rd Qu.:0.39047  
 Max.   :2.94983   Max.   :1.4705   Max.   :0.9649045   Max.   :0.90856  
       V5                V6                 V7                V8          
 Min.   :0.00202   Min.   :0.003248   Min.   :0.01255   Min.   :0.007663  
 1st Qu.:0.08923   1st Qu.:0.131931   1st Qu.:0.11021   1st Qu.:0.071183  
 Median :0.19367   Median :0.229757   Median :0.20144   Median :0.176220  
 Mean   :0.23782   Mean   :0.258516   Mean   :0.23157   Mean   :0.208148  
 3rd Qu.:0.33898   3rd Qu.:0.363191   3rd Qu.:0.33345   3rd Qu.:0.289976  
 Max.   :0.92712   Max.   :0.860870   Max.   :0.75328   Max.   :0.771221  
       V9                 V10           
 Min.   :0.0004054   Min.   :0.0001835  
 1st Qu.:0.0791780   1st Qu.:0.0783167  
 Median :0.1536091   Median :0.1595664  
 Mean   :0.1809388   Mean   :0.1815020  
 3rd Qu.:0.2617810   3rd Qu.:0.2667910  
 Max.   :0.5109728   Max.   :0.5197024  
> summary(do.call(rbind, err.sum2)[,c(1,3,5,7,9,2,4,6,8,10)])
       V1                V2                 V3               V4          
 Min.   :0.01165   Min.   :0.004362   Min.   :0.0140   Min.   :0.007293  
 1st Qu.:0.51397   1st Qu.:0.342168   1st Qu.:0.1901   1st Qu.:0.138317  
 Median :1.27250   Median :0.539960   Median :0.3538   Median :0.313209  
 Mean   :1.36527   Mean   :0.676032   Mean   :0.4276   Mean   :0.340417  
 3rd Qu.:1.95568   3rd Qu.:0.932587   3rd Qu.:0.6056   3rd Qu.:0.467018  
 Max.   :4.42027   Max.   :2.415901   Max.   :1.7181   Max.   :1.155565  
       V5                 V6                 V7                 V8          
 Min.   :0.004661   Min.   :0.001926   Min.   :0.002614   Min.   :0.001033  
 1st Qu.:0.143699   1st Qu.:0.057551   1st Qu.:0.052317   1st Qu.:0.089455  
 Median :0.236525   Median :0.092578   Median :0.122258   Median :0.143855  
 Mean   :0.256070   Mean   :0.125677   Mean   :0.135907   Mean   :0.183092  
 3rd Qu.:0.337112   3rd Qu.:0.166790   3rd Qu.:0.199672   3rd Qu.:0.252873  
 Max.   :0.779849   Max.   :0.451673   Max.   :0.417134   Max.   :0.580442  
       V9                V10           
 Min.   :0.001503   Min.   :0.0000486  
 1st Qu.:0.082923   1st Qu.:0.0743584  
 Median :0.159945   Median :0.1846448  
 Mean   :0.195048   Mean   :0.2206034  
 3rd Qu.:0.290641   3rd Qu.:0.3227924  
 Max.   :0.581568   Max.   :0.6625984  
> 
> proc.time()
   user  system elapsed 
  0.206   0.027   0.224 
